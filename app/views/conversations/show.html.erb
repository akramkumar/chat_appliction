<%= render "navbar" %>
<section style="background-color: darkgrey;">
  <div class="container py-5">

    <div class="row">
      <div class="col-md-12">

        <div class="card" id="chat3" style="border-radius: 15px;">
          <div class="card-body">

            <div class="row">
              <div class="col-md-6 col-lg-5 col-xl-4 mb-4 mb-md-0">

                <div class="p-3">
                  <%=render "search" %>
                  <div style="position: relative; height: 400px; overflow: auto;">
                    <ul class="list-unstyled mb-0">
                      <% @users.each do |user| %>
                        <%=render "list_user",user: user %>
                      <%end %>
                    </ul>
                  </div>

                </div>

              </div>

              <div class="col-md-6 col-lg-7 col-xl-8">
                <div class="card">
                  <div class="card-header d-flex justify-content-between align-items-center p-3"
                       style="border-top: 4px solid #ffa900;">
                      <div class="d-flex flex-row">
                      <%if @user1.profile_image.attached? %>
                        <%=image_tag @user1.profile_image,
                                     alt: "avatar 3", style: "width: 50px; height: 45px;", class: "d-flex align-self-center me-3 rounded-circle" %>
                      <%else %>
                        <img src="https://i0.wp.com/www.gosfordpark-coventry.org.uk/wp-content/uploads/blank-avatar.png?ssl=1"
                             alt="avatar 3" style="width: 40px; height: 100%;">
                      <%end %>
                      <div class="pt-1">
                      <p class="fw-bold mb-0"><%=@user1.name %></p>
                      <p class="small text-muted"><%=@user1.email %></p>
                      </div>
                      </div>





                  </div>
                </div>
                <div style="position: relative; height: 400px; overflow: auto;" class="pt-3 pe-3">
                  <div id="message">
                    <%@conversation.messages.each do |message| %>

                      <%if message.user_id==@user.id %>

                        <%=render 'sender_message',message: message %>

                      <%else %>
                        <%=render 'received_message',message:message %>
                      <%end %>

                    <% end %>
                  </div>

                </div>

                <div class="text-muted d-flex justify-content-start align-items-center pe-3 pt-3 mt-2">
                  <%if @user.profile_image.attached? %>
                    <%=image_tag @user.profile_image,
                                 alt: "avatar 3", style: "width: 60px; height: 50px;", class: "d-flex align-self-center me-3 rounded-circle" %>
                  <%else %>
                    <img src="https://i0.wp.com/www.gosfordpark-coventry.org.uk/wp-content/uploads/blank-avatar.png?ssl=1"
                         alt="avatar 3" style="width: 40px; height: 100%;">
                  <%end %>
                  <%=form_with(model: [@conversation,@message], local: false, class: "input-group rounded mb-3",html: { id: 'my-form' } ) do |f|%>
                  <%=f.text_field :body,class: "form-control form-control-lg", id:"exampleFormControlInput2",
                     placeholder: "Type message" %>

                  <button type="submit" class="ms-3"><i class="fas fa-paper-plane"></i></button>
                  <%end %>
                </div>

              </div>
            </div>

          </div>
        </div>

      </div>
    </div>

  </div>
</section>
